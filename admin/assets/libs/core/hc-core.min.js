/*! acp-core-js
Author:Leman Kwok <leman@lmswork.com>
Description:
Created:09-03-2017 12:56:34 */
!function(){var a={},b={};a.config={set:function(a,c){if("object"!=typeof arguments[0])b[a]=c;else{var d=arguments[0];for(var e in d)b[e]=d[e]}},get:function(a,c){return c||(c=null),a?"undefined"==typeof b[a]?c:b[a]:b}},window.hc=a}(),function(a){var b={code:null,text:{},setText:function(a,c){if("object"!=typeof a)b.text[a]=c;else for(var d in a)b.setText(d,a[d])},getText:function(a,c){var d=a,e=b.text,f=b.code;if("function"==typeof e?d=e(a):null!=f&&"undefined"!=typeof e[f][a]?d=e[f][a]:"undefined"!=typeof e[a]&&(d=e[a]),c)for(var a in c)d=d.replace("{"+a+"}",c[a]);return d}};a.loc=b}(hc),function(a){var b={};b.url=function(a,b){var c=b;return b&&"/"!=b.substr(b.length-1,1)&&a&&"/"!=a.substr(0,1)&&(c+="/"),c+a},b.site_url=function(c){return b.url(c,a.config.get("site_url",""))},b.asset_url=function(c){return b.url(c,a.config.get("asset_url",""))},a.net=b}(hc),function(a,b){var c=function(a){var c=b(a);b(d.modules).each(function(a,b){b(c)})},d={modules:[],initUIElement:c};a.ui=d}(hc,jQuery),function(exports,$){if(!$)return void console.error("ElementParser require jQuery");var _registeredDirectives={},_directiveKeys=[],defaultDirectives={text:function(a,b,c,d){"undefined"!=typeof moment&&"ago"==a.attr(""+d+"date-format")&&(c=moment(c).fromNow()),a.text(c)},href:function(a,b,c){a.prop("href",c)},target:function(a,b,c){a.prop("target",c)},placeholder:function(a,b,c){a.prop("placeholder",c)},data:function(a,b,c,d,e,f,g){if(c=defaultContentParser(g,"(function(){return "+b+"})()"),"object"==typeof c)for(var e in c)a.data(e,c[e])},attr:function(a,b,c,d,e,f,g){if(c=defaultContentParser(g,"(function(){return "+b+"})()"),"object"==typeof c)for(var e in c)a.attr(e,c[e])},id:function(a,b,c){a.prop("id",c)},name:function(a,b,c){a.prop("name",c)},"class":function(a,b,c){a.attr("class",c)},src:function(a,b,c){a.prop("src",c)},value:function(a,b,c){a.val(c)},title:function(a,b,c){a.prop("title",c)},html:function(a,b,c){a.html(c)},alt:function(a,b,c){a.prop("alt",c)},width:function(a,b,c){a.width(c)},height:function(a,b,c){a.height(c)},"background-image":function(a,b,c){a.css("background-image",c?"url("+c+")":"")},"if":function(a,b,c){c||a.remove()},"not-if":function(a,b,c){c&&a.remove()},loop:function(a,b,c,d,e,f){if(-1!=b.indexOf("..")){var g=b.split(".."),h=f(g[1]),i=a.parent();a.remove(),a.attr(d+e,null),$.isArray(h)&&$.each(h,function(b,c){var e={};e[g[0]]=c;var f=a.clone();i.append(f),hc.ui.ElementParser(f,e,d)})}}};defaultDirectives.data.isInternalParser=!0,defaultDirectives.attr.isInternalParser=!0,defaultDirectives.loop.isInternalParser=!0;var addDirective=function(a,b,c){return c||(c=_directiveKeys.length),"function"!=typeof b?(console.error("ElementParser.addDirective must pass function at 2th parameter"),!1):(_registeredDirectives[a]=b,c>=_directiveKeys.length?_directiveKeys.push(a):_directiveKeys.splice(c,0,a),!0)},getDirectiveAt=function(a){return 0>a||a>=_directiveKeys.length?null:_directiveKeys[a]},getDirective=function(a){return"undefined"!=typeof _registeredDirectives[a]?_registeredDirectives[a]:void 0},replaceDirective=function(a,b){"undefined"!=typeof _registeredDirectives[a]&&(_registeredDirectives[a]=b)},removeDirective=function(a){for(var b=[],c=0;c<_directiveKeys.length;c++)_directiveKeys[c]!=a&&b.push(_directiveKeys[c]);"undefined"!=typeof _registeredDirectives[a]&&(_registeredDirectives[a]=null,delete _registeredDirectives[a]),_directiveKeys=b},defaultContentParser=function(row,field){if("undefined"!=typeof field){if("undefined"!=typeof row[field])return row[field];try{with(row)return eval(field)}catch(err){}return""}};for(var key in defaultDirectives)addDirective(key,defaultDirectives[key]);var ElementParser=function(a,b,c){c||(c="rc-");var d=arguments[1];"function"!=typeof d&&(d=function(a){return ElementParser.contentParser(b,a)}),"function"!=typeof d&&(d=function(a){return defaultContentParser(b,a)}),$.each(_directiveKeys,function(e,f){var g=_registeredDirectives[f],h="function"==typeof g.parser?g.parser:d,i="undefined"!=typeof g.isInternalParser&&g.isInternalParser?g.isInternalParser:!1,j=c+f,k=a.find("["+j+"]");k.each(function(){var d=$(this),e=d.attr(j),k=i?null:h(e);g.call(a,d,e,k,c,f,h,b)})})};ElementParser.defaultDirectives=defaultDirectives,ElementParser.contentParser=defaultContentParser,ElementParser.addDirective=addDirective,ElementParser.getDirectiveAt=getDirectiveAt,ElementParser.getDirective=getDirective,ElementParser.removeDirective=removeDirective,ElementParser.replaceDirective=replaceDirective,exports.ElementParser=ElementParser}(hc.ui,jQuery);